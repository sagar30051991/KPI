[
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Ferro Pipeline", 
  "modified": "2016-01-09 18:57:26.847818", 
  "name": "Ferro Pipeline-Client", 
  "script": "cur_frm.add_fetch(\"pipeline_status\",\"deal_value\",\"deal_value\")\ncur_frm.add_fetch(\"pipeline_status\",\"probabilty_percentage\",\"probabilty_percentage\")\n//cur_frm.add_fetch(\"product_family\",\"product_model\",\"product_model\")\n//cur_frm.add_fetch(\"product_family\",\"quantity_required\",\"quantity_required\")\ncur_frm.add_fetch(\"contact_person\",\"mobile_no\",\"customer_contact_mobile\")\ncur_frm.add_fetch(\"customer_name\",\"vendor_code\",\"vendor_code\")\nfrappe.ui.form.on(\"Ferro Pipeline\",\"customer_name\",function(frm){\n\n\tfrappe.call({\n\t\tmethod:\"kpi.kpi.doctype.ferro_pipeline.ferro_pipeline.get_address\",\n\t\targs: {\n\t\t\t\t\"customer\":frm.doc.customer_name,\n\t\t},\n\t\tcallback: function(r) {\n\t\t\tif(r.message){\n\t\t\t\tfrm.doc.customer_location_city=r.message[0][0];\n\t\t\t\tfrm.doc.customer_location_state=r.message[0][1];\n\t\t\t\tfrm.doc.customer_email=r.message[0][2];\n\t\t\t\tfrm.doc.customer_contact_landline=r.message[0][3];\n\t\t\t\tfrm.doc.customer_vendor_code=r.message[0][4];\n\t\t\t\tfield=[\"customer_location_city\",\"customer_location_state\",\"customer_email\",\"customer_contact_landline\",\"vendor_code\"]\n\t\t\t\trefresh_field(field)\n\t\t\t}\n\t\t}\n\t})\n});\nfrappe.ui.form.on(\"Ferro Pipeline\", \"validate\", function(frm, cdt, cdn) {\n    var po_value = frm.doc.deal_value*frm.doc.probabilty_percentage/100;\n    cur_frm.set_value(\"po_value\", po_value);\n\n});\nfrappe.ui.form.on(\"Ferro Pipeline\", \"lead_date\", function(frm, cdt, cdn) {\n\tfrappe.call({\n \tmethod:\"kpi.kpi.doctype.ferro_pipeline.ferro_pipeline.get_week_of_year\",\n\targs: {\n\t\t\t\t\"date\":frm.doc.lead_date\n\t\t\t},\n\tcallback: function(r) {\n\n\t\t\tif(r.message){\n\t\t\t\tfrm.doc.week_of_year=r.message;\nfield=[\"week_of_year\"]\nrefresh_field(field)\n\t\t\t}\n\t\t}\n});\n});\ncur_frm.fields_dict['contact_person'].get_query=function(doc){\n return {\nfilters:{\n'customer':doc.customer_name\n}\n}\n}\n\ncur_frm.fields_dict['product_model'].get_query=function(doc){\n return {\nfilters:{\n'product_family':doc.product_family,\n}\n}\n}\nfrappe.ui.form.on(\"Ferro Pipeline\", \"salesperson\", function(frm, cdt, cdn) {\n\tfrappe.call({\n \tmethod:\"kpi.kpi.doctype.ferro_pipeline.ferro_pipeline.get_empname\",\n\targs: {\n\t\t\t\t\"salesperson\":frm.doc.salesperson\n\t\t\t},\n\tcallback: function(r) {\n\n\t\t\tif(r.message){\n\t\t\t\tfrm.doc.sale_person_name=r.message;\nfield=[\"sale_person_name\"]\nrefresh_field(field)\n\t\t\t}\n\t\t}\n});\n});", 
  "script_type": "Client"
 }, 
 {
  "docstatus": 0, 
  "doctype": "Custom Script", 
  "dt": "Ferro OrderFU", 
  "modified": "2016-01-11 16:41:40.258561", 
  "name": "Ferro OrderFU-Client", 
  "script": "cur_frm.cscript.custom_refresh = function(doc) {\nconsole.log(\"hiiiiiiiiiiiiiiiii\")\n    if(in_list(user_roles, \"Ferro User\")&&!in_list(user_roles, \"Administrator\")){\n         cur_frm.set_df_property(\"customer_name\", \"read_only\", doc.__islocal ? 0 : 1);\n\t\t cur_frm.set_df_property(\"customer_contact_person\", \"read_only\", doc.__islocal ? 0 : 1);\n\t\t cur_frm.set_df_property(\"customer_location_state\", \"read_only\", doc.__islocal ? 0 : 1);\n\t\t cur_frm.set_df_property(\"customer_contact_landline\", \"read_only\", doc.__islocal ? 0 : 1);\n\t\t cur_frm.set_df_property(\"customer_location_city\", \"read_only\", doc.__islocal ? 0 : 1);\n\t\t cur_frm.set_df_property(\"customer_contact_mobile\", \"read_only\", doc.__islocal ? 0 : 1);\n\t\t cur_frm.set_df_property(\"contact_person\", \"read_only\", doc.__islocal ? 0 : 1);\n\t\t cur_frm.set_df_property(\"po_number\", \"read_only\", doc.__islocal ? 0 : 1);\n\t\t cur_frm.set_df_property(\"wo_number\", \"read_only\", doc.__islocal ? 0 : 1);\n\t\t cur_frm.set_df_property(\"customer_email\", \"read_only\", doc.__islocal ? 0 : 1);\n\t\t cur_frm.set_df_property(\"discount\", \"read_only\", doc.__islocal ? 0 : 1);\ncur_frm.set_df_property(\"po_date\", \"read_only\", doc.__islocal ? 0 : 1);\ncur_frm.set_df_property(\"wo_date\", \"read_only\", doc.__islocal ? 0 : 1);\n         //FIELD BY FIELD IN THE DOCTYPE\n    }\n}\nfrappe.ui.form.on(\"Ferro OrderFU\", \"planned_delivery_date\", function(frm, cdt, cdn) {\n\tfrappe.call({\n \tmethod:\"kpi.kpi.doctype.ferro_orderfu.ferro_orderfu.get_datediff\",\n\targs: {\n\t\t\t\t\"date\":frm.doc.planned_delivery_date,\n                                \"date1\":frm.doc.quotation_date\n\t\t\t},\n\tcallback: function(r) {\n\n\t\t\tif(r.message){\n\t\t\t\tfrm.doc.lead_time_days=r.message;\nfield=[\"lead_time_days\"]\nrefresh_field(field)\n\t\t\t}\n\t\t}\n});\n});\nfrappe.ui.form.on(\"Ferro OrderFU\", \"po_date\", function(frm, cdt, cdn) {\n\tfrappe.call({\n \tmethod:\"kpi.kpi.doctype.ferro_orderfu.ferro_orderfu.get_week\",\n\targs: {\n\t\t\t\t\"date\":frm.doc.po_date\n\t\t\t},\n\tcallback: function(r) {\n\n\t\t\tif(r.message){\n\t\t\t\tfrm.doc.po_week=r.message;\nfield=[\"po_week\"]\nrefresh_field(field)\n\t\t\t}\n\t\t}\n});\n});\nfrappe.ui.form.on(\"Ferro OrderFU\", \"quotation_date\", function(frm, cdt, cdn) {\n\tfrappe.call({\n \tmethod:\"kpi.kpi.doctype.ferro_orderfu.ferro_orderfu.get_week\",\n\targs: {\n\t\t\t\t\"date\":frm.doc.quotation_date\n\t\t\t},\n\tcallback: function(r) {\n\n\t\t\tif(r.message){\n\t\t\t\tfrm.doc.delivery_week=r.message;\nfield=[\"delivery_week\"]\nrefresh_field(field)\n\t\t\t}\n\t\t}\n});\n});\nfrappe.ui.form.on(\"Ferro OrderFU\", \"validate\", function(frm, cdt, cdn) {\n    var basic_value = frm.doc.po_value*frm.doc.discount;\n    cur_frm.set_value(\"basic_value\", basic_value);\n\n});", 
  "script_type": "Client"
 }
]